name: CI/CD SQL Deployment (Calling Template)

on:
  push:
    branches: [ main ]
    paths: [ 'Database/**' ]

jobs:
  development:
    name: Deploy to Development (via Template)
    uses: ./.github/workflows/sql-template.yml
    with:
      sql_file: Database/setup1.sql
    secrets:
      sql_server: ${{ secrets.SQL_SERVER }}
      sql_user: ${{ secrets.SQL_USER }}
      sql_pass: ${{ secrets.SQL_PASS }}

  production:
    name: Deploy to Production (via Template)
    needs: development
    uses: ./.github/workflows/sql-template.yml
    with:
      sql_file: Database/setup1.sql
    secrets:
      sql_server: ${{ secrets.PROD_SQL_SERVER }}
      sql_user: ${{ secrets.PROD_SQL_USER }}
      sql_pass: ${{ secrets.PROD_SQL_PASS }}
